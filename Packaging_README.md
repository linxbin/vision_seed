# VisionSeed 项目打包指南

## 概述

本项目提供了多种方式将 VisionSeed Python 应用打包成 Windows 11 可运行的独立程序，严格遵循专业软件工程标准。

## 打包方式

### 方式一：快速批处理脚本（推荐新手）

```cmd
build.bat
```

特点：
- 自动化程度最高
- 一键完成所有步骤
- 包含基本的错误检查
- 适合快速打包测试

### 方式二：PowerShell脚本（推荐开发者）

```powershell
# 基本打包
.\build.ps1

# 仅清理构建目录
.\build.ps1 -CleanOnly

# 打包并立即测试运行
.\build.ps1 -TestRun

# 不创建发布包（仅生成dist目录）
.\build.ps1 -CreateRelease:$false
```

特点：
- 功能最丰富
- 详细的进度反馈
- 支持参数化控制
- 更好的错误处理
- 彩色输出显示

### 方式三：手动PyInstaller命令

```cmd
# 使用简化配置
pyinstaller build_simple.spec

# 使用完整配置（如果有图标文件）
pyinstaller build.spec
```

## 输出文件结构

打包完成后会生成以下目录：

```
项目根目录/
├── dist/                    # 直接可运行的程序
│   ├── VisionSeed.exe      # 主程序（约10-20MB）
│   ├── assets/             # 音效文件
│   ├── config/             # 配置文件
│   ├── core/               # 核心模块
│   ├── scenes/             # 场景模块
│   └── data/               # 数据目录
│
├── release/                # 完整发布包
│   └── VisionSeed.exe     # 独立可执行文件（包含所有依赖）
│
└── build/                  # 临时构建文件（可删除）
```

## 运行要求

目标机器需要满足以下条件：

### 最低配置
- Windows 10/11 操作系统
- DirectX 9.0c 或更高版本
- 50MB 可用磁盘空间

### 推荐配置
- Windows 11 专业版
- 4GB RAM
- 100MB 可用磁盘空间
- 支持音频输出的声卡

## 分发说明

### 单文件分发
- 将 `release/VisionSeed.exe` 单独发送给用户
- 用户无需安装额外依赖
- 启动时会自动解压到临时目录

### 完整包分发
- 将整个 `dist` 目录压缩后分发
- 用户解压后直接运行 `VisionSeed.exe`
- 启动速度更快，无需每次解压

## 故障排除

### 常见问题

1. **打包失败：找不到模块**
   ```
   解决：检查 requirements.txt 中的依赖是否完整
   ```

2. **程序运行时报错：DLL缺失**
   ```
   解决：确保目标机器安装了 Visual C++ 运行库
   下载地址：https://aka.ms/vs/17/release/vc_redist.x64.exe
   ```

3. **音效无法播放**
   ```
   解决：检查系统音频设置，确保不是静音状态
   ```

4. **程序窗口显示异常**
   ```
   解决：尝试调整Windows显示缩放设置为100%
   ```

### 调试模式

如果需要调试信息，可以使用带控制台的版本：

```cmd
# 临时修改 build_simple.spec 中的 console=True
# 然后重新打包，可以看到详细的运行日志
```

## 性能优化

### 减小文件体积
- 使用 UPX 压缩（已在配置中启用）
- 移除不必要的依赖
- 优化资源文件大小

### 提升启动速度
- 使用完整目录分发而非单文件
- 预编译常用模块
- 合理设置资源加载时机

## 版本管理建议

建议在发布新版本时：

1. 更新 `config/game.py` 中的版本号
2. 在 `release` 目录中添加版本说明文件
3. 使用语义化版本命名（如 v1.0.0）
4. 记录重要的功能变更和修复

## 安全考虑

- 所有用户数据保存在本地 `data` 目录
- 程序不收集任何用户隐私信息
- 建议在企业环境中进行病毒扫描
- 可以考虑代码签名提高可信度

---
*最后更新：2026年2月*
*适用于 VisionSeed v1.0*